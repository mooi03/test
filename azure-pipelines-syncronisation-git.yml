trigger:
  branches:
    include:
      - main

pool:
  name: 'default'

steps:
- checkout: self
  persistCredentials: true

- script: |
    echo "git checkout"
    git checkout main
    git remote remove azure || true
    git remote add azure "https://dev.azure.com/tlonchampt/armand/_git/armand"
    git remote -v
    git fetch azure
    git status
    if git show-ref --verify --quiet refs/heads/main; then
      git push azure main --force
    else
      echo "La branche 'main' n'existe pas dans le dépôt Azure."
      exit 1
    fi
  displayName: "Synchroniser GitHub avec Azure DevOps"
