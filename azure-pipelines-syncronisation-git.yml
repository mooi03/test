trigger:
  branches:
    include:
      - main

pool:
  name: 'default'

steps:
- checkout: self
  persistCredentials: true

- script: |
    git remote remove azure || true
    git remote add azure "https://dev.azure.com/tlonchampt/armand/_git/armand"
    git remote -v  # Affiche les remotes pour vérification
    git fetch azure
    git status  # Vérifie l'état actuel du dépôt
    if git show-ref --verify --quiet refs/heads/main; then
      git push azure main --force
    else
      echo "La branche 'main' n'existe pas dans le dépôt Azure."
      exit 1
    fi
  displayName: "Synchroniser GitHub avec Azure DevOps"
